@model IEnumerable<OnlineLibrary.Web.Models.StudentBookViewModel>

@{
    Layout = "_StudentLayout";
}

@{
    ViewData["Title"] = "Browse Books";
}

<div class="container mt-4">

    <h2>Browse Books</h2>
    <p class="text-muted">Choose books available for borrowing</p>
    <form method="get" class="mb-4">
        <div class="input-group">
            <input type="text"
                   name="search"
                   value="@Context.Request.Query["search"]"
                   class="form-control"
                   placeholder="Search by title, author, or category" />
            <button class="btn btn-dark">Search</button>
        </div>
    </form>


    <div class="row">
        @foreach (var book in Model)
        {
            <div class="col-md-3 mb-4">
                <div class="card shadow-sm h-100">

                    <img src="@book.ImageUrl"
                         class="card-img-top"
                         style="height:220px; object-fit:cover;"
                         onerror="this.src='/images/no-book.png'" />

                    <div class="card-body">
                        <h6 class="card-title">@book.Title</h6>
                        <p class="mb-1"><strong>Author:</strong> @book.Author</p>
                        <p class="mb-1"><strong>Category:</strong> @book.CategoryName</p>
                        <p class="mb-2">
                            <strong>Available:</strong>
                            @book.AvailableCopies
                        </p>

                        <a asp-controller="Book"
                           asp-action="Details"
                           asp-route-id="@book.BookId"
                           class="btn btn-sm btn-info w-100 mb-1">
                            View Details
                        </a>
                        @if (book.AvailableCopies > 0)
                        {
                            <a asp-controller="Borrow"
                               asp-action="Create"
                               asp-route-bookId="@book.BookId"
                               class="btn btn-sm btn-success w-100">
                                Borrow Book
                            </a>
                        }
                        else
                        {
                            <button class="btn btn-sm btn-secondary w-100" disabled>
                                Not Available
                            </button>
                        }
                    </div>

                </div>
            </div>
        }
    </div>
</div>
